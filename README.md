Autosoft Licensing System
1. System Overview
Autosoft Licensing is a secure, desktop-based application designed to manage the lifecycle of software licenses for Autosoft plugins. It allows administrators to process license requests, generate cryptographically signed license files, and manage product/user registries.

The system operates on a Request-Response model using two specific file formats:

.ARL (Autosoft Request License): A file generated by the client/plugin containing registration details.

.ASL (Autosoft Signed License): The encrypted license file generated by this tool, which the client imports to unlock features.

2. Core Licensing Logic & Security
The heart of the application is a cryptographic pipeline that ensures licenses cannot be forged or tampered with.

2.1 The Licensing Lifecycle
Request Generation (Client Side):

The client plugin collects user data (Company Name, Product ID, Dealer Code).

It creates a JSON object and calculates a SHA-256 checksum of the content.

The JSON is encoded (Base64) into an .ARL file.

Validation (Admin Tool):

When an admin uploads an .ARL file, the ArlReaderService parses the JSON.

Integrity Check: It recalculates the checksum of the data and compares it to the checksum embedded in the file. If they do not match, the file is rejected as "Tampered/Invalid."

Generation (Admin Tool):

The admin selects the license type (Demo or Subscription).

The AslGeneratorService creates a new LicenseData object including the generated License Key and Expiry Date.

Canonicalization: The JSON is serialized using a "Canonical" format (sorted keys, specific date formatting) to ensure consistent hashing across different machines.

Encryption (Output):

The final JSON payload is encrypted using AES-256-CBC (Advanced Encryption Standard).

The output is saved as an .ASL file.

Verification (Client Side):

The client decrypts the .ASL file using the shared secret key.

It verifies the checksum and checks if ExpiryDate > CurrentDate.

2.2 Security Standards used
Encryption: AES-256-CBC with PKCS7 Padding.

Hashing: SHA-256 for integrity verification.

Key Management: Keys and IVs are currently configured in the application settings (Note: Production deployments should secure these keys).

3. Application Modules
The application is divided into distinct functional modules, each handled by specific UI pages and backend services.

3.1 License Generation Module
Page: GenerateLicensePage.cs This is the primary workspace for the administrator.

File Upload: Accepts .ARL files. Automatically populates Company Name, Product ID, and requested parameters.

Business Rules Engine:

Demo Mode: If "Demo" is selected, the duration is strictly locked to 1 Month.

Subscription Mode: Defaults to 12 Months but allows manual override by the admin.

License Key Generation: Uses LicenseKeyGenerator to create a unique, formatted key (e.g., XXXX-XXXX-XXXX-XXXX).

Output: Generates the encrypted .ASL file for the user to download.

3.2 License Records Module
Page: LicenseRecordsPage.cs & LicenseRecordDetailsPage.cs Acts as the historical audit trail for the system.

Data Grid: Displays a paginated list of all generated licenses.

Filtering: Allows searching by Company Name, License Key, or Product.

Details View: Clicking a record shows deep metadata, including the original request date, the admin who approved it, and the raw license parameters.

Status Tracking: Visual indicators show if a license is Active or Expired.

3.3 Product Management Module
Page: ManageProductPage.cs & ProductDetailsPage.cs Allows the configuration of software products that can be licensed.

CRUD Operations: Create, Read, Update, and Delete products.

Module Definition: Admins can define sub-modules for a product (e.g., "Accounting", "Inventory") which can be individually enabled/disabled in the license.

Validation: Ensures Product IDs are unique to prevent licensing conflicts.

3.4 User Management Module
Page: ManageUserPage.cs & UserDetailsPage.cs Controls access to the Licensing Tool itself.

Role Management: (Currently supports Admin roles).

Security: Passwords and user credentials are managed here.

Audit: Tracks which user generated which license (stored in the License History).

3.5 Authentication Module
Page: LoginPage.cs

The entry point of the application.

Validates credentials against the Users table in the database.

Establishes the current Session context used for audit logging.

4. Technical Architecture
4.1 Backend Services
The application relies on a Service-Oriented Architecture (SOA) via Dependency Injection.

LicenseRequestService: Handles the logic of parsing and validating incoming .ARL requests.

EncryptionService: Wraps the .NET cryptography libraries to provide consistent Encrypt/Decrypt methods.

LicenseDatabaseService: Manages all SQL interactions (Dapper/ADO.NET) for storing records, products, and users.

CanonicalJsonSerializer: A custom serializer ensuring that JSON is always formatted identically (date formats, property ordering) to guarantee checksum matches between the Admin Tool and Client Plugins.

4.2 Database Schema
The system uses a relational database (SQL Server) with the following core entities:

Licenses: Stores the generated license keys, expiry dates, and payload references.

Dealers/Customers: Stores the entities requesting the licenses.

Products: Defines the software catalog.

Users: Administrators of the tool.

5. Setup & Configuration
Prerequisites:

Windows OS (WinForms support).

.NET Framework / Core Runtime.

SQL Server instance.

Database Initialization:

Run Schema.sql to create the tables.

Run Seed.sql to insert initial admin users and default products.

App.config:

Ensure the ConnectionStrings points to your SQL Server instance.

Important: Verify the EncryptionKey and IV match the keys used in your Client Plugin, or licenses will not work.
